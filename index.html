<!DOCTYPE html>
<html>
<head>
    <title>Babylon.js FPS Game with Gravity</title>
    <style>
        html, body { width: 100%; height: 100%; padding: 0; margin: 0; }
        #gameCanvas { width: 100%; height: 100%; }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/cannon.js"></script> <!-- Include Cannon.js for Physics -->
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const canvas = document.getElementById('gameCanvas');
            const engine = new BABYLON.Engine(canvas, true);

            const createScene = () => {
                const scene = new BABYLON.Scene(engine);
                scene.enablePhysics(new BABYLON.Vector3(0, -1.81, 0), new BABYLON.CannonJSPlugin()); // Enable physics with gravity

                const camera = new BABYLON.UniversalCamera('camera1', new BABYLON.Vector3(0, 50, -50), scene);
                camera.setTarget(BABYLON.Vector3.Zero());
                camera.attachControl(canvas, false);
                camera.keysUp.push(87);    // W
                camera.keysDown.push(83);  // S
                camera.keysLeft.push(65);  // A
                camera.keysRight.push(68); // D
                camera.applyGravity = true; // Apply gravity to the camera
                camera.ellipsoid = new BABYLON.Vector3(2, 2, 2); // Set the collision bounds
                camera.checkCollisions = true; // Enable collision detection

                canvas.addEventListener('click', () => {
                    if (!scene.isPointerLock) {
                        canvas.requestPointerLock = canvas.requestPointerLock || canvas.msRequestPointerLock;
                        canvas.requestPointerLock();
                    }
                }, false);

                new BABYLON.HemisphericLight('light1', new BABYLON.Vector3(0,1,0), scene);

                // Taivas
                const skyMaterial = new BABYLON.SkyMaterial("skyMaterial", scene);
                skyMaterial.backFaceCulling = false;

                const skybox = BABYLON.MeshBuilder.CreateBox("skyBox", { size: 1000.0 }, scene);
                 skybox.material = skyMaterial;
                   //
                
              const ground = BABYLON.Mesh.CreateGround('ground1', 2000, 2000, 2, scene);
               const groundMaterial = new BABYLON.StandardMaterial("groundMat", scene);
               groundMaterial.diffuseTexture = new BABYLON.Texture("https://doc.babylonjs.com/img/resources/textures_thumbs/grass.dds.jpg", scene);
              ground.material = groundMaterial;

                ground.checkCollisions = true; // Enable ground collision

                // Create a box
                const box = BABYLON.Mesh.CreateBox('box1', 20, scene);
                const boxMaterial = new BABYLON.StandardMaterial("groundMat", scene);
                boxMaterial.diffuseTexture = new BABYLON.Texture("https://doc.babylonjs.com/img/resources/textures_thumbs/grass.dds.jpg", scene);
               box.material = boxMaterial;

                box.position.y = 1; // Position the box above the ground
                box.checkCollisions = true; // Enable box collision

                return scene;
            };

            const scene = createScene();
            engine.runRenderLoop(() => {
                scene.render();
            });

            window.addEventListener('resize', () => {
                engine.resize();
            });
        });
    </script>
</body>
</html>

